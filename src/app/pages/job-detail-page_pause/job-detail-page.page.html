<ion-header>
  <ion-toolbar style="--min-height: 100px">
    <ion-title style="padding-bottom: 50px">3/3</ion-title>
    <ion-title>Post Job</ion-title>
  </ion-toolbar>

  <ion-toolbar>
    <ion-segment-button value="basic" [disabled]="true">
    <ion-label class="ion-text-wrap">Basic Details</ion-label>
  </ion-segment-button>

       <ion-segment-button value="company" [disabled]="true">
    <ion-label class="ion-text-wrap">Company Details</ion-label>
  </ion-segment-button>

     <ion-segment [(ngModel)]="selectedSegment" >
  <ion-segment-button value="job" style="background: #833aa6; color: white !important;;">
    <ion-label class="ion-text-wrap" >Job Details</ion-label>
  </ion-segment-button>
    </ion-segment>
  </ion-toolbar>
</ion-header>


<ion-content class="ion-padding" [fullscreen]="true" scroll-y="true">
  <ion-segment-view value="job">
    <ion-segment-content id="job">
      <form [formGroup]="jobForm"  class="scrollable-form">
        <div class="box">
          <h2 class="heading" style="text-align: center;">Job Details</h2>

         <!-- Job Title -->
<ion-item>
  <ion-label position="stacked">Job Title <span style="color: red">*</span></ion-label>
  <ion-input type="text" formControlName="jobTitle" placeholder="Enter job title"></ion-input>
</ion-item>
<ion-text color="danger" *ngIf="jobForm.get('jobTitle')?.touched && jobForm.get('jobTitle')?.invalid">
  <small *ngIf="jobForm.get('jobTitle')?.errors?.['required']">Name is required</small>
  <small *ngIf="jobForm.get('jobTitle')?.errors?.['minlength']">Minimum 3 characters</small>
</ion-text>

          <!-- Job Category -->
<ion-item lines="none">
  <ion-label class="label" >Job Category <span style="color: red" >*</span></ion-label>
</ion-item>

<ng-select
  [items]="dropdownOptions"
  bindLabel="category_name"
  bindValue="id"
  placeholder="Search to select a job category"
  formControlName="jobCategory"
  [searchable]="true"
  [multiple]="false"
  [closeOnSelect]="false"
  [clearable]="false"
  class="custom-job-select"
>
</ng-select>

<ion-text color="danger" *ngIf="jobForm.get('jobCategory')?.touched && jobForm.get('jobCategory')?.invalid">
  <small *ngIf="jobForm.get('jobCategory')?.errors?.['required']">Job category is required</small>
</ion-text>


       <!-- Job Type -->
<ion-item lines="none">
  <ion-label class="label">Job Type <span style="color: red">*</span></ion-label>
</ion-item>

<div class="job-type-toggle">
  <ion-button
    shape="round"
    [fill]="jobType === 'fulltime' ? 'solid' : 'outline'"
    [ngClass]="jobType === 'fulltime' ? 'purple-button' : 'medium'"
    (click)="selectjobType('fulltime')"
    type="button"
  >
    Full Time
  </ion-button>
  <ion-button
    shape="round"
    [fill]="jobType === 'parttime' ? 'solid' : 'outline'"
    [ngClass]="jobType === 'parttime' ? 'purple-button' : 'medium'"
    (click)="selectjobType('parttime')"
    type="button"
  >
    Part Time
  </ion-button>
</div>

<ion-text color="danger" *ngIf="jobForm.get('jobType')?.touched && jobForm.get('jobType')?.invalid">
  <small *ngIf="jobForm.get('jobType')?.errors?.['required']">Job Type is required</small>
</ion-text>


        <!-- No. of Positions Open -->
<ion-item lines="none">
  <ion-label class="label">No. of Positions Open <span style="color: red">*</span></ion-label>
</ion-item>
<ion-input
  type="number"
  formControlName="positionsOpen"
  placeholder="Enter number of positions"
></ion-input>
<ion-text color="danger" *ngIf="jobForm.get('positionsOpen')?.touched && jobForm.get('positionsOpen')?.invalid">
  <small *ngIf="jobForm.get('positionsOpen')?.errors?.['required']">No. of positions is required</small>
</ion-text>

<!-- Job Description -->
<ion-item lines="none">
  <ion-label class="label">Job Description <span style="color: red">*</span></ion-label>
</ion-item>
<ion-textarea 
  autoGrow="false"

  formControlName="jobDescription"
  placeholder="Enter job description"
></ion-textarea>
<ion-text color="danger" *ngIf="jobForm.get('jobDescription')?.touched && jobForm.get('jobDescription')?.invalid">
  <small *ngIf="jobForm.get('jobDescription')?.errors?.['required']">Job description is required</small>
</ion-text>

         <!-- Candidate Requirement -->
<ion-item lines="none">
  <ion-label class="label">Candidate Requirement <span style="color: red">*</span></ion-label>
</ion-item>

<div class="candidate-type-toggle">
  <ion-button
    shape="round"
    [fill]="candidatetype === 'fresher' ? 'solid' : 'outline'"
    [ngClass]="candidatetype === 'fresher' ? 'purple-button' : 'medium'"
    (click)="selectcanType('fresher')"
    type="button"
  >
    Fresher
  </ion-button>

  <ion-button
    shape="round"
    [fill]="candidatetype === 'experienced' ? 'solid' : 'outline'"
    [ngClass]="candidatetype === 'experienced' ? 'purple-button' : 'medium'"
    (click)="selectcanType('experienced')"
    type="button"
  >
    Experienced
  </ion-button>

</div>

<ion-text color="danger" *ngIf="jobForm.get('candidatetype')?.touched && jobForm.get('candidatetype')?.invalid">
  <small *ngIf="jobForm.get('candidatetype')?.errors?.['required']">Candidate Requirement is required</small>
</ion-text>

          <!-- Experience -->
<ng-container *ngIf="candidatetype">
  
  <!-- For Fresher -->
  <ng-container *ngIf="candidatetype === 'fresher'">
    <ion-item>
      <ion-label position="stacked">Min Experience</ion-label>
      <ion-input formControlName="minexp" value="Fresher" readonly></ion-input>
    </ion-item>

    <ion-item>
      <ion-label position="stacked">Max Experience</ion-label>
      <ion-input formControlName="maxexp" value="Fresher" readonly></ion-input>
    </ion-item>
  </ng-container>

  <!-- For Experienced -->
  <ng-container *ngIf="candidatetype === 'experienced'">
    <ion-item>
      <ion-label position="stacked">Min Experience</ion-label>
      <ion-select formControlName="minexp" placeholder="Select minimum years">
        <ion-select-option value="">Fresher</ion-select-option>
        <ion-select-option *ngFor="let year of years" [value]="year">{{ year }} year{{ year > 1 ? 's' : '' }}</ion-select-option>
        <ion-select-option value="30+">30+ years</ion-select-option>
      </ion-select>
    </ion-item>

    <ion-item>
      <ion-label position="stacked">Max Experience</ion-label>
      <ion-select formControlName="maxexp" placeholder="Select maximum years">
        <ion-select-option *ngFor="let year of years" [value]="year">{{ year }} year{{ year > 1 ? 's' : '' }}</ion-select-option>
        <ion-select-option value="30+">30+ years</ion-select-option>
      </ion-select>
    </ion-item>
  </ng-container>

</ng-container>


         <!-- Gender -->
<ion-item lines="none">
  <ion-label class="label">Select Gender <span style="color: red">*</span></ion-label>
</ion-item>

<div class="gender-type-toggle">
  <ion-button
    shape="round"
    [fill]="isgender === 'male' ? 'solid' : 'outline'"
    [ngClass]="isgender === 'male' ? 'purple-button' : 'medium'"
    (click)="selectgenderType('male')"
    type="button"
  >
    Male
  </ion-button>

  <ion-button
    shape="round"
    [fill]="isgender === 'female' ? 'solid' : 'outline'"
    [ngClass]="isgender === 'female' ? 'purple-button' : 'medium'"
    (click)="selectgenderType('female')"
    type="button"
  >
    Female
  </ion-button>

  <ion-button
    shape="round"
    [fill]="isgender === 'other' ? 'solid' : 'outline'"
    [ngClass]="isgender === 'other' ? 'purple-button' : 'medium'"
    (click)="selectgenderType('other')"
    type="button"
  >
    Others
  </ion-button>

</div>

<ion-text color="danger" *ngIf="jobForm.get('isgender')?.touched && jobForm.get('isgender')?.invalid">
  <small *ngIf="jobForm.get('isgender')?.errors?.['required']">Gender field is required</small>
</ion-text>


          <!-- Candidate Location -->
<ion-item lines="none">
  <ion-label class="label">Candidate Location <span style="color: red">*</span></ion-label>
</ion-item>

<div class="location-toggle">
  <ion-button
    *ngFor="let location of locations"
    shape="round"
    [fill]="selectedLocation === location ? 'solid' : 'outline'"
    [ngClass]="selectedLocation === location ? 'purple-button' : 'medium'"
    (click)="selectLocation(location)"
    type="button"
  >
    {{ location }}
  </ion-button>
</div>

<ion-text
  color="danger"
  *ngIf="jobForm.get('locations')?.touched && jobForm.get('locations')?.invalid"
>
  <small *ngIf="jobForm.get('locations')?.errors?.['required']">
    Candidate Location is required
  </small>
</ion-text>


         <!-- Work From Home -->
<ion-item lines="none">
  <ion-label class="label">Is this a work from home job? <span style="color: red">*</span></ion-label>
</ion-item>

<div class="work-type-toggle">
  <ion-button
    shape="round"
    [fill]="WorkFromHome === 'yes' ? 'solid' : 'outline'"
    [ngClass]="WorkFromHome === 'yes' ? 'purple-button' : 'medium'"
    (click)="selectWorkType('yes')"
    type="button"
  >
    Yes
  </ion-button>

  <ion-button
    shape="round"
    [fill]="WorkFromHome === 'no' ? 'solid' : 'outline'"
    [ngClass]="WorkFromHome === 'no' ? 'purple-button' : 'medium'"
    (click)="selectWorkType('no')"
    type="button"
  >
    No
  </ion-button>
</div>

<ion-text
  color="danger"
  *ngIf="jobForm.get('WorkFromHome')?.touched && jobForm.get('WorkFromHome')?.invalid"
>
  <small *ngIf="jobForm.get('WorkFromHome')?.errors?.['required']">
    Choose any one option
  </small>
</ion-text>


<!-- Qualification -->
<ion-item lines="none">
  <ion-label class="label">Minimum Qualification <span style="color: red">*</span></ion-label>
</ion-item>

<ng-select
  [items]="qualification"
  bindLabel="value"
  bindValue="id"
  placeholder="Search to select a qualification"
  formControlName="qualification"
  [searchable]="true"
>
</ng-select>

<ion-text
  color="danger"
  *ngIf="jobForm.get('qualification')?.touched && jobForm.get('qualification')?.invalid"
>
  <small *ngIf="jobForm.get('qualification')?.errors?.['required']">
    Qualification field is required
  </small>
</ion-text>


        <!-- Salary -->
<ion-item lines="none">
  <ion-label class="label">Salary per Month <span style="color: red">*</span></ion-label>
</ion-item>
<ion-input
  type="number"
  formControlName="salary"
  placeholder="Enter salary amount"
></ion-input>
<ion-text
  color="danger"
  *ngIf="jobForm.get('salary')?.touched && jobForm.get('salary')?.invalid"
>
  <small *ngIf="jobForm.get('salary')?.errors?.['required']">
    Field is required
  </small>
</ion-text>

<!-- Skills -->
<ion-item lines="none">
  <ion-label class="label">Mention Skills required <span style="color: red">*</span></ion-label>
</ion-item>
<ng-select
  [items]="selectedSkills"
  bindLabel="value"
  bindValue="id"
  [multiple]="true"
  [searchable]="true"
  [closeOnSelect]="false"
  [clearable]="true"
  placeholder="Select skills"
  formControlName="skills"
  class="custom-skill-select"
  [addTag]="false"
>
  <!-- Display selected skills as chips -->
  <ng-template ng-multi-label-tmp let-items="items">
    <div class="selected-skill-chip" *ngFor="let item of items">
      {{ item.value }}
      <span class="remove-chip" (click)="removeSkill(item)">âœ•</span>
    </div>
  </ng-template>
</ng-select>

<ion-text
  color="danger"
  *ngIf="jobForm.get('skills')?.touched && jobForm.get('skills')?.invalid"
>
  <small *ngIf="jobForm.get('skills')?.errors?.['required']">
    Skills field is required
  </small>
</ion-text>


        <!-- Security Deposit -->
<ion-item lines="none">
  <ion-label class="label">
    Is there any security deposit charged to the candidate (Eg. Uniform, Kit, Bike)? <span style="color: red">*</span>
  </ion-label>
</ion-item>

<div class="security-toggle">
  <ion-button
    shape="round"
    [fill]="issecuritygiven === 'yes' ? 'solid' : 'outline'"
    [ngClass]="issecuritygiven === 'yes' ? 'purple-button' : 'medium'"
    (click)="selectsecurity('yes')"
    type="button"
  >
    Yes
  </ion-button>

  <ion-button
    shape="round"
    [fill]="issecuritygiven === 'no' ? 'solid' : 'outline'"
    [ngClass]="issecuritygiven === 'no' ? 'purple-button' : 'medium'"
    (click)="selectsecurity('no')"
    type="button"
  >
    No
  </ion-button>
</div>

<ion-text
  color="danger"
  *ngIf="jobForm.get('issecuritygiven')?.touched && jobForm.get('issecuritygiven')?.invalid"
>
  <small *ngIf="jobForm.get('issecuritygiven')?.errors?.['required']">
    Choose any one option
  </small>
</ion-text>


         <!-- Languages Known -->
<ion-item lines="none">
  <ion-label class="label">
    Languages Known <span style="color: red">*</span>
  </ion-label>
</ion-item>

<div formArrayName="languages">
  <div *ngFor="let langGroup of languages.controls; let i = index" [formGroupName]="i">
    
    <!-- <ion-label>Language {{ i + 1 }}</ion-label> -->
    <ng-select
      [items]="languageOptions"
      bindLabel="value"
      bindValue="id"
      placeholder="Search to select a language"
      formControlName="language"
      [searchable]="true"
     
    ></ng-select>

  <div class="rws" formGroupName="rws">
  <ion-row>
    <ion-col size="4">
      <div class="language-btn">
        <ion-checkbox slot="start" formControlName="read" class="lang-checkbox"></ion-checkbox>
        <span class="lang-label">Read</span>
      </div>
    </ion-col>
    <ion-col size="4">
      <div class="language-btn">
        <ion-checkbox slot="start" formControlName="write" class="lang-checkbox"></ion-checkbox>
        <span class="lang-label">Write</span>
      </div>
    </ion-col>
    <ion-col size="4">
      <div class="language-btn">
        <ion-checkbox slot="start" formControlName="speak" class="lang-checkbox"></ion-checkbox>
        <span class="lang-label">Speak</span>
      </div>
    </ion-col>
  </ion-row>
</div>



    <ion-text color="danger" *ngIf="langGroup.get('language')?.touched && langGroup.get('language')?.invalid">
      <small *ngIf="langGroup.get('language')?.errors?.['required']">Select any one Language</small>
    </ion-text>

    <div class="languageAddRem">
      <ion-button (click)="addLanguage()" color="success" [disabled]="languages.length > 4">Add</ion-button>
      <ion-button (click)="removeLanguage(i)" color="danger" *ngIf="languages.length > 1">Remove</ion-button>
    </div>

  </div>
</div>


     <!-- Job Timing -->
<ion-item lines="none">
  <ion-label class="label">
    Job Timing <span style="color: red">*</span>
  </ion-label>
</ion-item>

<ion-item>
  <ion-label position="stacked">Start Time</ion-label>
  <ion-input type="time" formControlName="jobStartTime"></ion-input>
</ion-item>
<ion-text color="danger" *ngIf="jobForm.get('jobStartTime')?.touched && jobForm.get('jobStartTime')?.invalid">
  <small *ngIf="jobForm.get('jobStartTime')?.errors?.['required']">Field is required</small>
</ion-text>

<ion-item>
  <ion-label position="stacked">End Time</ion-label>
  <ion-input type="time" formControlName="jobEndTime"></ion-input>
</ion-item>
<ion-text color="danger" *ngIf="jobForm.get('jobEndTime')?.touched && jobForm.get('jobEndTime')?.invalid">
  <small *ngIf="jobForm.get('jobEndTime')?.errors?.['required']">Field is required</small>
</ion-text>

<!-- Interview Details -->
<ion-item lines="none">
  <ion-label class="label">
    Interview Details <span style="color: red">*</span>
  </ion-label>
</ion-item>

<ion-item>
  <ion-label position="stacked">Timing</ion-label>
  <ion-select formControlName="interviewTime" placeholder="Select Timings">
    <ion-select-option value="9:00 AM - 11:00 AM">9:00 AM - 11:00 AM</ion-select-option>
    <ion-select-option value="11:00 AM- 1:00 PM">11:00 AM- 1:00 PM</ion-select-option>
    <ion-select-option value="2:00 PM - 4:00 PM">2:00 PM - 4:00 PM</ion-select-option>
    <ion-select-option value="4:00 PM - 6:00 PM">4:00 PM - 6:00 PM</ion-select-option>
  </ion-select>
</ion-item>
<ion-text color="danger" *ngIf="jobForm.get('interviewTime')?.touched && jobForm.get('interviewTime')?.invalid">
  <small *ngIf="jobForm.get('interviewTime')?.errors?.['required']">Select any time slot</small>
</ion-text>

<ion-item>
  <ion-label position="stacked">Day</ion-label>
  <ion-select formControlName="interviewDay" placeholder="Select Day" [multiple]="true">
    <ion-select-option value="Sunday">Sunday</ion-select-option>
    <ion-select-option value="Monday">Monday</ion-select-option>
    <ion-select-option value="Tuesday">Tuesday</ion-select-option>
    <ion-select-option value="Wednesday">Wednesday</ion-select-option>
    <ion-select-option value="Thursday">Thursday</ion-select-option>
    <ion-select-option value="Friday">Friday</ion-select-option>
    <ion-select-option value="Saturday">Saturday</ion-select-option>
  </ion-select>
</ion-item>
<ion-text color="danger" *ngIf="jobForm.get('interviewDay')?.touched && jobForm.get('interviewDay')?.invalid">
  <small *ngIf="jobForm.get('interviewDay')?.errors?.['required']">Select any one day</small>
</ion-text>


      <!-- Terms -->
<ion-checkbox formControlName="acceptTerms" labelPlacement="end" style="margin-top: 10px">
  I Accept Terms and Conditions and <br />Privacy Policy <span style="color: red">*</span>
</ion-checkbox>

<ion-text color="danger" *ngIf="jobForm.controls['acceptTerms'].touched && jobForm.controls['acceptTerms'].invalid">
  <small>You must accept the terms and conditions</small>
</ion-text>

<div class="submit-buttons">
  <ion-button class="submitbtn" (click)="previousPage()">Back</ion-button>
  <ion-button class="submitbtn" (click)="submitForm()" type="submit" [disabled]="jobForm.invalid">Submit</ion-button>
</div>

</div>
      </form>
    </ion-segment-content>
  </ion-segment-view>
</ion-content>
